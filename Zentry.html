<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="description" content="Zentry â€” Example fully working web UI (Boards, Messenger, Docs, Drive, Calendar, etc.)" />
  <title>Zentry</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet"/>
  <style>
    :root { --glass-bg: rgba(255,255,255,0.12); }
    body { font-family: "Inter", sans-serif; }
    /* Scrollbar for sidebar */
    .sidebar-scroll::-webkit-scrollbar { width: 6px; }
    .sidebar-scroll::-webkit-scrollbar-thumb { background-color: rgba(244, 69, 69, 0.2); border-radius: 10px; }
    .sidebar-scroll::-webkit-scrollbar-track { background: transparent; }
    .route-hidden { display: none !important; }
    /* small helpers (no Tailwind @apply in plain <style>) */
    .btn { border-radius: 0.375rem; padding: 0.5rem 0.75rem; font-weight: 600; font-size: .9rem; }
    .card { background-color: rgba(255,255,255,0.95); border-radius: 0.75rem; box-shadow: 0 6px 18px rgba(2,6,23,0.08); }
    .pill { font-size: .72rem; padding: 0.12rem .45rem; border-radius: 9999px; display:inline-block; }
    .badge { font-size: .66rem; padding: 0.12rem .45rem; border-radius: 9999px; display:inline-block; }
    /* small responsive tweaks */
    @media (max-width: 900px) {
      aside.sidebar-scroll { display:none; }
      main { margin-left: 0; }
    }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-b from-[#5a5ea9] to-[#a9b9d9] relative overflow-x-hidden">
  <!-- Fullscreen decorative background images -->
  <div class="fixed inset-0 w-full h-full -z-10 pointer-events-none select-none">
    <img id="bg-image" alt="" class="absolute inset-0 w-full h-full object-cover opacity-60" src="     "/>
    <input id="bg-image-input" type="file" accept="image/*" class="hidden" />
    <button id="bg-image-btn" class="absolute top-4 right-4 z-10 bg-white bg-opacity-60 hover:bg-opacity-90 text-gray-800 px-3 py-1 rounded shadow text-xs font-semibold">Change Background</button>
    <script>
      document.getElementById('bg-image-btn').addEventListener('click', function() {
      document.getElementById('bg-image-input').click();
      });
      document.getElementById('bg-image-input').addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = function(ev) {
        document.getElementById('bg-image').src = ev.target.result;
        localStorage.setItem('zentry_bg_image', ev.target.result);
      };
      reader.readAsDataURL(file);
      });
      // Load saved background image if exists
      const saved = localStorage.getItem('zentry_bg_image');
      if (saved) document.getElementById('bg-image').src = saved;
    </script>
  </div>
  
  
  <div class="flex min-h-screen">
    <!-- Sidebar -->
    <aside class="sidebar-scroll relative w-64 bg-gradient-to-b from-[#5a5ea9] to-[#a9b9d9] bg-opacity-70 backdrop-blur-md text-white flex flex-col px-5 py-6" role="navigation" aria-label="Main navigation">
      <div class="flex items-center space-x-3 mb-8">
        <button aria-label="Open menu" class="text-white text-2xl"><i class="fas fa-bars"></i></button>
        <span class="font-semibold text-xl select-none">Zentry <span class="text-[10px] ml-1"></span></span>
      </div>

      <nav class="flex-1 overflow-y-auto pr-1" id="sidebar-nav">
        <div class="mb-4 opacity-50 text-sm flex items-center space-x-1 select-none">
          <i class="fas fa-project-diagram text-base"></i><span>Collaboration</span><i class="fas fa-chevron-down text-xs"></i>
        </div>

        <ul class="space-y-3 text-white text-base font-normal" role="menu" aria-label="Sidebar menu">
          <li><a data-route="messenger" class="navlink flex items-center space-x-3 hover:opacity-100 opacity-70 cursor-pointer" role="menuitem">
            <i class="far fa-comment-alt text-lg"></i><span>Messenger</span>
            <span id="badge-messages" class="ml-auto bg-red-600 text-white text-xs font-semibold rounded-full w-5 h-5 flex items-center justify-center select-none">1</span>
          </a></li>
          <li><a data-route="feed" class="navlink flex items-center space-x-3 hover:opacity-100 opacity-70 cursor-pointer" role="menuitem"><i class="far fa-newspaper text-lg"></i><span>Feed</span></a></li>
          <li><a data-route="collabs" class="navlink flex items-center space-x-3 hover:opacity-100 opacity-70 cursor-pointer" role="menuitem"><i class="fas fa-cubes text-lg"></i><span>Collabs</span></a></li>
          <li><a data-route="calendar" class="navlink flex items-center space-x-3 hover:opacity-100 opacity-70 cursor-pointer" role="menuitem"><i class="far fa-calendar-alt text-lg"></i><span>Calendar</span></a></li>
          <li><a data-route="docs" class="navlink flex items-center space-x-3 hover:opacity-100 opacity-70 cursor-pointer" role="menuitem"><i class="far fa-file-alt text-lg"></i><span>Online documents</span></a></li>
          <li><a data-route="boards" class="navlink flex items-center space-x-3 bg-white bg-opacity-20 rounded-lg px-4 py-2 font-normal cursor-pointer" role="menuitem"><i class="fas fa-columns text-lg"></i><span>Boards</span></a></li>
          <li><a data-route="drive" class="navlink flex items-center space-x-3 hover:opacity-100 opacity-70 cursor-pointer" role="menuitem"><i class="fas fa-credit-card text-lg"></i><span>Drive</span></a></li>
          <li><a data-route="webmail" class="navlink flex items-center space-x-3 hover:opacity-100 opacity-70 cursor-pointer" role="menuitem"><i class="far fa-envelope text-lg"></i><span>Webmail</span></a></li>
          <li><a data-route="workgroups" class="navlink flex items-center space-x-3 hover:opacity-100 opacity-70 cursor-pointer" role="menuitem"><i class="fas fa-users text-lg"></i><span>Workgroups</span></a></li>
        </ul>

        <div class="mt-8 mb-6 opacity-70 text-base flex items-center space-x-3 select-none">
          <i class="far fa-check-square text-lg"></i><span>Tasks & Projects</span>
        </div>
        <div class="opacity-70 text-base flex items-center space-x-3 select-none mb-6">
          <i class="fas fa-cog text-lg"></i><span>Settings</span>
        </div>
      </nav>

      <button id="btn-upgrade" class="w-full py-2 rounded-md bg-gradient-to-r from-[#ff7e5f] to-[#b76bff] text-white font-semibold flex items-center justify-center space-x-2">
        <i class="fas fa-rocket"></i><span>Upgrade your plan</span>
      </button>
    </aside>

    <!-- Main -->
    <main class="flex-1 flex flex-col min-h-screen" role="main">
      <!-- Top nav -->
      <header class="flex items-center space-x-6 bg-gradient-to-r from-[#5a5ea9] to-[#a9b9d9] bg-opacity-70 backdrop-blur-md px-6 py-3 text-white select-none">
        <nav class="flex items-center space-x-6 flex-1 text-sm font-normal" aria-label="Top navigation">
          <a data-route="feed" class="toplink hover:underline cursor-pointer">Feed</a>
          <a data-route="messenger" class="toplink relative hover:underline cursor-pointer">
            Messenger
            <span class="absolute -top-2 -right-3 bg-red-600 text-white text-xs font-semibold rounded-full w-5 h-5 flex items-center justify-center select-none" id="badge-messages-top">1</span>
          </a>
          <a data-route="calendar" class="toplink hover:underline cursor-pointer">Calendar <i class="fas fa-chevron-down text-xs"></i></a>
          <a data-route="docs" class="toplink hover:underline cursor-pointer">Online documents</a>
          <a data-route="boards" class="toplink bg-white bg-opacity-30 rounded-md px-3 py-1 text-white font-semibold cursor-pointer">Boards</a>
          <a class="hover:underline cursor-default">More <i class="fas fa-chevron-down text-xs"></i></a>
        </nav>
        <div class="flex items-center space-x-4">
          <button aria-label="Search" class="text-white opacity-80 hover:opacity-100"><i class="fas fa-search"></i></button>
          <span class="font-semibold select-none">Zentry <span class="text-[10px] ml-1"></span></span>
          <button class="border border-white border-opacity-50 rounded-full px-3 py-1 text-white text-xs font-semibold hover:bg-white hover:bg-opacity-20">Invite</button>
          <button class="bg-green-600 hover:bg-green-700 rounded-full px-4 py-1 text-white text-xs font-semibold">Buy Now</button>
          <button class="bg-[#a87f4a] hover:bg-[#b18a4a] rounded-full px-4 py-1 text-white text-xs font-semibold">Helpdesk</button>
          <button aria-label="User profile" class="w-8 h-8 rounded-full bg-white bg-opacity-30 flex items-center justify-center">
            <i class="fas fa-user-circle text-white text-2xl"></i>
          </button>
        </div>
      </header>

      <!-- ROUTES WRAPPER -->
      <section class="flex-1 p-6 overflow-auto">
        <!-- FEED -->
        <div data-route-panel="feed" class="route card p-4 route-hidden" aria-live="polite">
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-xl font-semibold">Company Feed</h2>
            <button id="feed-new-post" class="btn bg-green-600 text-white hover:bg-green-700"><i class="fas fa-plus mr-2"></i>New Post</button>
          </div>
          <div id="feed-posts" class="space-y-4"></div>
        </div>

        <!-- MESSENGER -->
        <div data-route-panel="messenger" class="route card p-0 route-hidden" aria-label="Messenger">
          <div class="grid md:grid-cols-3">
            <div class="p-4 border-r">
              <div class="flex items-center justify-between mb-2">
                <h3 class="font-semibold">Chats</h3>
                <button id="chat-new" class="text-xs px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700" title="Start new chat"><i class="fas fa-plus"></i></button>
              </div>
              <input id="chat-search" class="w-full mb-3 rounded-md border px-3 py-2" placeholder="Searchâ€¦" aria-label="Search chats">
              <ul id="chat-list" class="space-y-2 max-h-[60vh] overflow-y-auto" role="list"></ul>
            </div>
            <div class="md:col-span-2 flex flex-col h-full">
              <div id="chat-header" class="p-4 border-b flex items-center justify-between">
                <div class="flex items-center space-x-2">
                  <div id="chat-avatar" class="w-8 h-8 rounded-full bg-gray-200"></div>
                  <div>
                    <div id="chat-name" class="font-semibold">Select a chat</div>
                    <div id="chat-status" class="text-xs text-gray-500">â€”</div>
                  </div>
                </div>
                <div class="text-sm text-gray-500" id="chat-info"></div>
              </div>
              <div id="chat-thread" class="flex-1 p-4 overflow-y-auto space-y-3" tabindex="0" aria-live="polite"></div>
              <form id="chat-form" class="p-4 border-t flex items-center space-x-2" aria-label="Send message">
                <input id="chat-input" class="flex-1 rounded-md border px-3 py-2" placeholder="Type a messageâ€¦" autocomplete="off" />
                <button class="btn bg-green-600 text-white hover:bg-green-700" type="submit"><i class="fas fa-paper-plane"></i></button>
              </form>
            </div>
          </div>
        </div>

        <!-- COLLABS (Kanban) -->
        <div data-route-panel="collabs" class="route route-hidden">
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-xl font-semibold text-white">Collabs â€“ Kanban</h2>
            <button id="kanban-add" class="btn bg-white/30 text-white hover:bg-white/50"><i class="fas fa-plus mr-2"></i>Add Task</button>
          </div>
          <div class="grid md:grid-cols-3 gap-4">
            <div class="card p-3">
              <div class="font-semibold mb-2">Backlog</div>
              <div id="kanban-backlog" class="min-h-[200px] space-y-2" data-col="backlog"></div>
            </div>
            <div class="card p-3">
              <div class="font-semibold mb-2">In Progress</div>
              <div id="kanban-progress" class="min-h-[200px] space-y-2" data-col="progress"></div>
            </div>
            <div class="card p-3">
              <div class="font-semibold mb-2">Done</div>
              <div id="kanban-done" class="min-h-[200px] space-y-2" data-col="done"></div>
            </div>
          </div>
        </div>

        <!-- CALENDAR -->
        <div data-route-panel="calendar" class="route card p-4 route-hidden">
          <div class="flex items-center justify-between mb-3">
            <h2 class="text-xl font-semibold">Calendar</h2>
            <div class="flex items-center space-x-2">
              <button id="cal-prev" class="btn bg-gray-100 hover:bg-gray-200" aria-label="Previous month"><i class="fas fa-chevron-left"></i></button>
              <div id="cal-title" class="font-semibold"></div>
              <button id="cal-next" class="btn bg-gray-100 hover:bg-gray-200" aria-label="Next month"><i class="fas fa-chevron-right"></i></button>
              <button id="cal-today" class="btn bg-green-600 text-white hover:bg-green-700">Today</button>
            </div>
          </div>
          <div id="calendar-grid" class="grid grid-cols-7 gap-2" aria-live="polite"></div>
          <div class="mt-4">
            <h3 class="font-semibold mb-2">Events</h3>
            <div id="event-list" class="space-y-2"></div>
          </div>
        </div>

        <!-- ONLINE DOCUMENTS -->
        <div data-route-panel="docs" class="route card p-4 route-hidden">
          <div class="flex items-center justify-between mb-3">
            <h2 class="text-xl font-semibold">Online Documents</h2>
            <button id="doc-new" class="btn bg-green-600 text-white hover:bg-green-700"><i class="fas fa-file-alt mr-2"></i>New Doc</button>
          </div>
          <div id="doc-list" class="grid md:grid-cols-2 lg:grid-cols-3 gap-3"></div>

          <!-- Editor Modal -->
          <div id="doc-modal" class="fixed inset-0 hidden items-center justify-center bg-black/40 z-40" role="dialog" aria-modal="true" aria-labelledby="doc-title">
            <div class="bg-white rounded-lg w-[min(900px,95vw)] p-4 relative">
              <button id="doc-close" class="absolute top-3 right-3 text-gray-600 hover:text-black" aria-label="Close editor"><i class="fas fa-times text-xl"></i></button>
              <div class="flex items-center space-x-2 mb-3">
                <input id="doc-title" class="flex-1 rounded border px-3 py-2" placeholder="Document title" aria-label="Document title">
                <button id="doc-save" class="btn bg-green-600 text-white hover:bg-green-700"><i class="fas fa-save mr-2"></i>Save</button>
              </div>
              <textarea id="doc-body" class="w-full h-[60vh] rounded border p-3" placeholder="Start writingâ€¦" aria-label="Document body"></textarea>
            </div>
          </div>
        </div>

        <!-- BOARDS -->
        <div data-route-panel="boards" class="route route-hidden">
          <div class="relative rounded-xl overflow-hidden bg-white bg-opacity-20 backdrop-blur-md flex flex-col h-full">
            <div class="flex flex-col md:flex-row md:items-center md:justify-between px-6 py-4">
              <div class="flex items-center space-x-3 mb-3 md:mb-0">
                <h1 class="text-white text-2xl font-semibold select-none">Boards</h1>
                <button aria-label="Pin boards" class="text-white opacity-70 hover:opacity-100"><i class="fas fa-thumbtack"></i></button>
              </div>
              <div class="flex items-center space-x-3">
                <button id="board-create-btn" class="bg-green-600 hover:bg-green-700 rounded-md px-4 py-2 text-white font-semibold flex items-center space-x-2">
                  <i class="fas fa-plus"></i><span>Create</span>
                </button>
                <div class="relative">
                  <input id="board-search" class="pl-10 pr-4 py-2 rounded-md bg-white bg-opacity-30 placeholder-white placeholder-opacity-70 text-white focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="Filter and search" type="text"/>
                  <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-white opacity-70 pointer-events-none"></i>
                </div>
              </div>
            </div>

            <div class="px-6 mb-4">
              <nav class="inline-flex rounded-md bg-white bg-opacity-20 text-white text-sm font-semibold select-none" id="board-view-tabs">
                <button data-view="list" class="px-4 py-1 rounded-l-md bg-white bg-opacity-40">List</button>
                <button data-view="grid" class="px-4 py-1 opacity-70 hover:opacity-100">Grid</button>
                <button data-view="tile" class="px-4 py-1 rounded-r-md opacity-70 hover:opacity-100">Tile</button>
              </nav>
            </div>

            <div id="boards-container" class="flex-1 px-6 pb-6">
              <div id="boards-header" class="grid grid-cols-5 text-gray-700 bg-white bg-opacity-90 px-6 py-3 rounded-t-xl font-normal select-none">
                <div class="flex items-center space-x-2 cursor-pointer" id="sort-name">
                  <i class="fas fa-cog text-gray-400"></i><span>File name</span><i class="fas fa-sort ml-1 text-gray-400 text-xs"></i>
                </div>
                <div class="flex items-center space-x-1 cursor-pointer" id="sort-active">
                  <span>Active</span><i class="fas fa-chevron-down text-xs"></i>
                </div>
                <div>Created by</div>
                <div>Shared</div>
                <div class="flex items-center space-x-1 cursor-pointer" id="sort-date">
                  <span>Published</span><i class="fas fa-sort ml-1 text-gray-400 text-xs"></i>
                </div>
              </div>

              <div id="boards-list" class="bg-white rounded-b-xl"></div>
              <div id="boards-grid" class="route-hidden grid sm:grid-cols-2 lg:grid-cols-3 gap-4"></div>
              <div id="boards-tile" class="route-hidden grid sm:grid-cols-2 lg:grid-cols-4 gap-4"></div>
            </div>
          </div>

          <!-- Create/Edit Board Modal -->
          <div id="board-modal" class="fixed inset-0 hidden items-center justify-center bg-black/40 z-40" role="dialog" aria-modal="true" aria-labelledby="board-modal-title">
            <div class="bg-white rounded-lg w-[min(700px,95vw)] p-5 relative">
              <button id="board-close" class="absolute top-3 right-3 text-gray-600 hover:text-black" aria-label="Close"><i class="fas fa-times text-xl"></i></button>
              <h3 id="board-modal-title" class="text-lg font-semibold mb-3">Create Board</h3>
              <div class="grid md:grid-cols-2 gap-3">
                <div><label class="text-sm">Name</label><input id="board-name" class="w-full rounded border px-3 py-2" placeholder="e.g., Sprint Planning"></div>
                <div><label class="text-sm">Owner</label><input id="board-owner" class="w-full rounded border px-3 py-2" placeholder="Your name"></div>
                <div class="md:col-span-2"><label class="text-sm">Shared With (comma-separated)</label><input id="board-shared" class="w-full rounded border px-3 py-2" placeholder="alice@ex.com, bob@ex.com"></div>
                <div class="flex items-center space-x-2"><input id="board-active" type="checkbox" class="rounded border"><label>Active</label></div>
                <div class="flex items-center space-x-2"><input id="board-published" type="date" class="rounded border px-2 py-1"><span class="text-xs text-gray-500">Published date</span></div>
              </div>
              <div class="flex justify-end mt-4 space-x-2">
                <button id="board-delete" class="btn bg-red-100 text-red-700 hidden hover:bg-red-200"><i class="fas fa-trash mr-2"></i>Delete</button>
                <button id="board-save" class="btn bg-green-600 text-white hover:bg-green-700"><i class="fas fa-save mr-2"></i>Save</button>
              </div>
            </div>
          </div>
        </div>

        <!-- DRIVE -->
        <div data-route-panel="drive" class="route card p-4 route-hidden">
          <div class="flex items-center justify-between mb-3">
            <h2 class="text-xl font-semibold">Drive</h2>
            <div class="flex items-center space-x-2">
              <input id="drive-input" type="file" class="hidden" multiple aria-hidden="true"/>
              <button id="drive-upload" class="btn bg-green-600 text-white hover:bg-green-700"><i class="fas fa-upload mr-2"></i>Upload</button>
            </div>
          </div>
          <div id="drive-list" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-3"></div>
        </div>

        <!-- WEBMAIL -->
        <div data-route-panel="webmail" class="route card p-0 route-hidden">
          <div class="grid md:grid-cols-3">
            <div class="p-4 border-r">
              <div class="flex items-center justify-between mb-2">
                <h3 class="font-semibold">Inbox</h3>
                <button id="mail-compose" class="text-xs px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700" title="Compose"><i class="fas fa-pen"></i></button>
              </div>
              <ul id="mail-list" class="space-y-2 max-h-[60vh] overflow-y-auto"></ul>
            </div>
            <div class="md:col-span-2 flex flex-col">
              <div id="mail-view" class="p-4">
                <div class="text-gray-500">Select an emailâ€¦</div>
              </div>
            </div>
          </div>
        </div>

        <!-- WORKGROUPS -->
        <div data-route-panel="workgroups" class="route card p-4 route-hidden">
          <div class="flex items-center justify-between mb-3">
            <h2 class="text-xl font-semibold">Workgroups</h2>
            <button id="wg-add" class="btn bg-green-600 text-white hover:bg-green-700"><i class="fas fa-user-friends mr-2"></i>Add Group</button>
          </div>
          <div id="wg-list" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-3"></div>
        </div>
      </section>

      <!-- Right vertical icons bar -->
      <aside aria-label="Quick actions" class="fixed top-32 right-4 flex flex-col space-y-4 z-20 select-none">
        <button aria-label="My Drive" data-route="drive" class="quicklink bg-white bg-opacity-20 rounded-full w-10 h-10 flex items-center justify-center text-white opacity-70 hover:opacity-100"><i class="fas fa-credit-card"></i></button>
        <button aria-label="Settings" class="bg-white bg-opacity-20 rounded-full w-10 h-10 flex items-center justify-center text-white opacity-70 hover:opacity-100"><i class="fas fa-cog"></i></button>
        <button aria-label="Recycle Bin" class="bg-white bg-opacity-20 rounded-full w-10 h-10 flex items-center justify-center text-white opacity-70 hover:opacity-100"><i class="fas fa-trash-alt"></i></button>
        <button aria-label="Notifications" data-route="messenger" class="quicklink bg-white bg-opacity-20 rounded-full w-10 h-10 flex items-center justify-center text-white opacity-70 hover:opacity-100"><i class="fas fa-bell"></i></button>
        <button aria-label="Radar" class="bg-white bg-opacity-10 rounded-full w-10 h-10 flex items-center justify-center text-white opacity-40 cursor-not-allowed" disabled><i class="fas fa-bullseye"></i></button>
        <button aria-label="Sync" class="bg-white bg-opacity-10 rounded-full w-10 h-10 flex items-center justify-center text-white opacity-40 cursor-not-allowed" disabled><i class="fas fa-sync-alt"></i></button>
      </aside>

      <!-- Avatars 
      <aside aria-label="User avatars" class="fixed top-44 right-4 flex flex-col space-y-4 z-30 select-none">
        <div class="relative">
          <img alt="User avatar" class="rounded-full border-2 border-white" height="40" src="https://storage.googleapis.com/a1aa/image/3853303b-e5e8-4f0b-31a5-2249b6f99bbf.jpg" width="40"/>
          <span id="avatar-badge" class="absolute -top-1 -right-1 bg-red-600 text-white text-xs font-semibold rounded-full w-5 h-5 flex items-center justify-center">1</span>
        </div>
        <img alt="" class="rounded-full border-2 border-white opacity-50" height="40" src="https://storage.googleapis.com/a1aa/image/6941ffbc-965d-47dc-84a1-109228bd9b6d.jpg" width="40"/>
        <img alt="" class="rounded-full border-2 border-white opacity-50" height="40" src="https://storage.googleapis.com/a1aa/image/b6e3eb70-523b-4520-fc57-49de28bae192.jpg" width="40"/>
        <img alt="" class="rounded-full border-2 border-white opacity-50" height="40" src="https://storage.googleapis.com/a1aa/image/e69f220f-da01-4e46-e50e-8b1efe7efbd6.jpg" width="40"/>
      </aside>
    </main>
  </div>  -->

  <!-- Global Toast -->
  <div id="toast" class="fixed bottom-4 left-1/2 -translate-x-1/2 bg-black/80 text-white px-4 py-2 rounded-md opacity-0 pointer-events-none transition-opacity" role="status" aria-live="polite"></div>

  <script>
    /***************
     * Utilities
     ***************/
    const $ = (s, ctx=document) => ctx.querySelector(s);
    const $$ = (s, ctx=document) => Array.from(ctx.querySelectorAll(s));
    const uid = () => Math.random().toString(36).slice(2,9);
    const toast = (msg, t=1400) => {
      const el = $('#toast'); el.textContent = msg;
      el.style.pointerEvents = 'auto';
      el.classList.remove('opacity-0'); el.classList.add('opacity-100');
      setTimeout(()=>{ el.classList.remove('opacity-100'); el.classList.add('opacity-0'); el.style.pointerEvents = 'none'; }, t);
    };
    const store = {
      get(k, fallback){ try{ const v = localStorage.getItem(k); return v ? JSON.parse(v) : fallback; } catch { return fallback; } },
      set(k,v){ try{ localStorage.setItem(k, JSON.stringify(v)); } catch(e){ console.warn('storage', e); } }
    };
    function escapeHtml(s=''){ return String(s).replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }
    function escapeAttr(s=''){ return escapeHtml(s).replace(/"/g,'&quot;'); }
    function toISO(d){ const y=d.getFullYear(); const m=String(d.getMonth()+1).padStart(2,'0'); const day=String(d.getDate()).padStart(2,'0'); return `${y}-${m}-${day}`; }

    /***********************
     * Router
     ***********************/
    const Router = {
      current: 'boards',
      init(){
        const initial = location.hash.replace('#/','') || 'boards';
        this.show(initial);
        window.addEventListener('hashchange', ()=> {
          const r = location.hash.replace('#/','') || 'boards';
          this.show(r);
        });
        // nav binding
        $$('.navlink, .toplink, .quicklink').forEach(el=>{
          el.addEventListener('click', (e)=>{
            const r = el.dataset.route;
            if (!r) return;
            e.preventDefault();
            location.hash = '#/' + r;
          });
        });
      },
      show(route){
        this.current = route;
        $$('.route').forEach(p => p.classList.add('route-hidden'));
        const panel = document.querySelector(`[data-route-panel="${route}"]`);
        if (panel) panel.classList.remove('route-hidden');

        // update active states
        $$('.navlink').forEach(a => a.classList.remove('bg-white','bg-opacity-20','px-4','py-2','rounded-lg'));
        const active = $(`.navlink[data-route="${route}"]`); if (active) active.classList.add('bg-white','bg-opacity-20','px-4','py-2','rounded-lg');
        $$('.toplink').forEach(a => a.classList.remove('bg-white','bg-opacity-30','px-3','py-1','font-semibold'));
        const top = $(`.toplink[data-route="${route}"]`); if (top) top.classList.add('bg-white','bg-opacity-30','px-3','py-1','font-semibold');

        // call renderers for route
        if (route === 'boards') Boards.render();
        if (route === 'docs') Docs.render();
        if (route === 'drive') Drive.render();
        if (route === 'webmail') Mail.render();
        if (route === 'collabs') Kanban.render();
        if (route === 'calendar') Calendar.render();
        if (route === 'feed') Feed.render();
        if (route === 'messenger') Messenger.render();
        if (route === 'workgroups') Workgroups.render();
      }
    };

    /***********************
     * FEED
     ***********************/
    const Feed = {
      key: 'zentry_feed',
      posts: [],
      init(){
        this.posts = store.get(this.key, [
          { id: uid(), author: 'Admin', time: Date.now()-3600e3, text: 'Welcome to Zentry! ðŸŽ‰', likes: 3, comments: [] }
        ]);
        $('#feed-new-post').addEventListener('click', ()=> {
          const text = prompt('Write your post:');
          if (!text) return;
          this.posts.unshift({ id: uid(), author: 'You', time: Date.now(), text, likes: 0, comments: [] });
          store.set(this.key, this.posts); this.render();
        });
      },
      render(){
        const wrap = $('#feed-posts'); wrap.innerHTML = '';
        this.posts.forEach(p=>{
          const el = document.createElement('div'); el.className = 'card p-4';
          el.innerHTML = `
            <div class="flex items-center justify-between">
              <div class="font-semibold">${escapeHtml(p.author)}</div>
              <div class="text-xs text-gray-500">${new Date(p.time).toLocaleString()}</div>
            </div>
            <div class="mt-2">${escapeHtml(p.text)}</div>
            <div class="mt-3 flex items-center space-x-3">
              <button class="text-sm px-2 py-1 rounded bg-gray-100 hover:bg-gray-200 like-btn"><i class="far fa-thumbs-up mr-1"></i>Like (${p.likes})</button>
              <button class="text-sm px-2 py-1 rounded bg-gray-100 hover:bg-gray-200 comment-btn"><i class="far fa-comment mr-1"></i>Comment</button>
            </div>
            <div class="mt-2 space-y-1 text-sm text-gray-700">${p.comments.map(c=>`<div><span class="font-medium">${c.by}:</span> ${escapeHtml(c.text)}</div>`).join('')}</div>
          `;
          el.querySelector('.like-btn').addEventListener('click', ()=> { p.likes++; store.set(this.key,this.posts); this.render(); });
          el.querySelector('.comment-btn').addEventListener('click', ()=> {
            const text = prompt('Your comment:'); if (!text) return;
            p.comments.push({ by: 'You', text }); store.set(this.key,this.posts); this.render();
          });
          wrap.appendChild(el);
        });
      }
    };

    /***********************
     * MESSENGER
     ***********************/
    const Messenger = {
      key: 'zentry_chats',
      chats: [],
      activeId: null,
      init(){
        this.chats = store.get(this.key, [
          { id: uid(), name:'Alice', avatar:'ðŸŸ£', unread:1, last: Date.now()-120000, messages:[{ me:false, text:'Hey! Welcome!', time:Date.now()-120000 }]},
          { id: uid(), name:'Bob', avatar:'ðŸŸ¢', unread:0, last: Date.now()-7200000, messages:[{ me:false, text:'Standup at 10?', time:Date.now()-7200000 }]},
        ]);
        $('#chat-new').addEventListener('click', ()=> {
          const name = prompt('Start chat with (name):'); if (!name) return;
          this.chats.unshift({ id: uid(), name, avatar:'ðŸŸ¤', unread:0, last: Date.now(), messages:[] });
          store.set(this.key, this.chats); this.render();
        });
        $('#chat-form').addEventListener('submit', (e)=> {
          e.preventDefault();
          const input = $('#chat-input'); const text = input.value.trim();
          if (!text || !this.activeId) return;
          const c = this.chats.find(c=>c.id===this.activeId);
          c.messages.push({ me:true, text, time: Date.now() }); c.last = Date.now();
          store.set(this.key, this.chats); input.value=''; this.renderThread();
          // simulated reply
          setTimeout(()=> {
            c.messages.push({ me:false, text:'Got it ðŸ‘', time: Date.now() });
            if (Router.current !== 'messenger') c.unread = (c.unread||0) + 1;
            store.set(this.key, this.chats); updateMessageBadges();
            if (Router.current === 'messenger' && this.activeId === c.id) this.renderThread();
          }, 700);
        });
        $('#chat-search').addEventListener('input', ()=> this.renderList());
      },
      render(){ this.renderList(); this.renderHeader(); this.renderThread(); },
      renderList(){
        const ul = $('#chat-list'); const q = $('#chat-search').value?.toLowerCase() || '';
        ul.innerHTML = '';
        this.chats
          .filter(c => c.name.toLowerCase().includes(q))
          .sort((a,b)=>b.last-a.last)
          .forEach(c=>{
            const li = document.createElement('li');
            li.className = `p-2 rounded border cursor-pointer ${this.activeId===c.id?'bg-green-50 border-green-200':'bg-white'}`;
            li.innerHTML = `<div class="flex items-center justify-between"><div class="font-medium">${escapeHtml(c.name)}</div>${c.unread?`<span class="badge bg-red-600 text-white">${c.unread}</span>`:''}</div><div class="text-xs text-gray-500">${new Date(c.last).toLocaleString()}</div>`;
            li.addEventListener('click', ()=> {
              this.activeId = c.id; c.unread = 0; store.set(this.key,this.chats); updateMessageBadges(); this.render();
            });
            ul.appendChild(li);
          });
      },
      renderHeader(){
        const c = this.chats.find(x=>x.id===this.activeId);
        $('#chat-name').textContent = c ? c.name : 'Select a chat';
        $('#chat-status').textContent = c ? 'Online recently' : 'â€”';
        $('#chat-info').textContent = c ? `Messages: ${c.messages.length}` : '';
      },
      renderThread(){
        const wrap = $('#chat-thread'); wrap.innerHTML = '';
        const c = this.chats.find(x=>x.id===this.activeId);
        if (!c) { wrap.innerHTML = `<div class="text-gray-500">No chat selected.</div>`; return; }
        c.messages.forEach(m=>{
          const row = document.createElement('div');
          row.className = `flex ${m.me?'justify-end':''}`;
          row.innerHTML = `<div class="${m.me?'bg-green-600 text-white':'bg-gray-100'} rounded-lg px-3 py-2 max-w-[75%]"><div class="text-sm">${escapeHtml(m.text)}</div><div class="text-[10px] opacity-70 mt-1">${new Date(m.time).toLocaleTimeString()}</div></div>`;
          wrap.appendChild(row);
        });
        wrap.scrollTop = wrap.scrollHeight;
      }
    };

    function updateMessageBadges(){
      const total = Messenger.chats.reduce((s,c)=> s + (c.unread||0), 0);
      const b1 = $('#badge-messages'); const b2 = $('#badge-messages-top'); const a = $('#avatar-badge');
      [b1,b2,a].forEach(b=>{
        if (!b) return;
        if (total > 0) { b.textContent = total; b.classList.remove('hidden'); } else { b.classList.add('hidden'); }
      });
    }

    /***********************
     * KANBAN
     ***********************/
    const Kanban = {
      key:'zentry_kanban',
      items:[],
      init(){
        this.items = store.get(this.key, [
          { id: uid(), col:'backlog', title:'Set up repo', assignee:'A', priority:'High' },
          { id: uid(), col:'progress', title:'Design mockups', assignee:'B', priority:'Med' },
          { id: uid(), col:'done', title:'Kickoff meeting', assignee:'C', priority:'Low' }
        ]);
        $('#kanban-add').addEventListener('click', ()=> {
          const title = prompt('Task title:'); if (!title) return;
          this.items.push({ id: uid(), col:'backlog', title, assignee:'You', priority:'Med' });
          store.set(this.key,this.items); this.render();
        });
        // drag & drop
        ['kanban-backlog','kanban-progress','kanban-done'].forEach(id=>{
          const col = document.getElementById(id);
          col.addEventListener('dragover', e=> e.preventDefault());
          col.addEventListener('drop', e=>{
            const itemId = e.dataTransfer.getData('text/plain');
            const it = this.items.find(x=>x.id===itemId);
            if (it){ it.col = col.dataset.col; store.set(this.key,this.items); this.render(); }
          });
        });
      },
      card(it){
        const div = document.createElement('div'); div.className = 'p-3 rounded border bg-white cursor-grab';
        div.draggable = true;
        div.addEventListener('dragstart', e => e.dataTransfer.setData('text/plain', it.id));
        div.innerHTML = `<div class="font-medium">${escapeHtml(it.title)}</div><div class="text-xs text-gray-500 mt-1">Assignee: ${escapeHtml(it.assignee)} â€¢ <span class="pill bg-gray-100">${it.priority}</span></div><div class="mt-2 flex items-center justify-end space-x-2"><button class="text-xs px-2 py-0.5 rounded bg-gray-100 hover:bg-gray-200 edit">Edit</button><button class="text-xs px-2 py-0.5 rounded bg-red-100 text-red-700 hover:bg-red-200 del">Delete</button></div>`;
        div.querySelector('.edit').addEventListener('click', ()=> {
          const t = prompt('Edit title:', it.title); if (!t) return;
          it.title = t; store.set(this.key,this.items); this.render();
        });
        div.querySelector('.del').addEventListener('click', ()=> {
          this.items = this.items.filter(x=>x.id!==it.id); store.set(this.key,this.items); this.render();
        });
        return div;
      },
      render(){
        $('#kanban-backlog').innerHTML=''; $('#kanban-progress').innerHTML=''; $('#kanban-done').innerHTML='';
        this.items.forEach(it=>{
          const container = it.col === 'backlog' ? '#kanban-backlog' : it.col === 'progress' ? '#kanban-progress' : '#kanban-done';
          $(container).appendChild(this.card(it));
        });
      }
    };

    /***********************
     * CALENDAR
     ***********************/
    const Calendar = {
      key:'zentry_events',
      date: new Date(),
      events: [],
      init(){
        this.events = store.get(this.key, [{ id: uid(), date: toISO(new Date()), title:'Daily Standup', time:'10:00' }]);
        $('#cal-prev').addEventListener('click', ()=>{ this.date.setMonth(this.date.getMonth()-1); this.render(); });
        $('#cal-next').addEventListener('click', ()=>{ this.date.setMonth(this.date.getMonth()+1); this.render(); });
        $('#cal-today').addEventListener('click', ()=>{ this.date = new Date(); this.render(); });
      },
      render(){
        const year = this.date.getFullYear(); const month = this.date.getMonth();
        $('#cal-title').textContent = `${this.date.toLocaleString(undefined,{month:'long'})} ${year}`;
        const first = new Date(year, month, 1);
        const startDay = (first.getDay()+6)%7;
        const days = new Date(year, month+1, 0).getDate();
        const grid = $('#calendar-grid'); grid.innerHTML='';
        for(let i=0;i<startDay;i++){ const s=document.createElement('div'); grid.appendChild(s); }
        for(let d=1; d<=days; d++){
          const iso = toISO(new Date(year, month, d));
          const dayEvents = this.events.filter(e=>e.date===iso);
          const col = document.createElement('div'); col.className = 'border rounded p-2 bg-white/90';
          col.innerHTML = `<div class="text-xs text-gray-500 flex items-center justify-between"><span>${d}</span><button class="text-[10px] px-1 py-0.5 rounded bg-green-100 hover:bg-green-200 add">Add</button></div><div class="mt-1 space-y-1">${dayEvents.map(e=>`<div class="text-xs bg-gray-100 rounded px-1 py-0.5 flex items-center justify-between"><span>${escapeHtml(e.title)} â€¢ ${e.time}</span><button data-id="${e.id}" class="del text-red-600">Ã—</button></div>`).join('')}</div>`;
          col.querySelector('.add').addEventListener('click', ()=> {
            const title = prompt('Event title:'); if (!title) return;
            const time = prompt('Time (HH:MM):','10:00') || '10:00';
            this.events.push({ id: uid(), date: iso, title, time }); store.set(this.key,this.events); this.render();
          });
          col.querySelectorAll('.del').forEach(btn=> btn.addEventListener('click', ()=> {
            const id = btn.dataset.id; this.events = this.events.filter(e=>e.id!==id); store.set(this.key,this.events); this.render();
          }));
          grid.appendChild(col);
        }
        const list = $('#event-list'); list.innerHTML='';
        this.events.sort((a,b)=> (a.date+a.time).localeCompare(b.date+b.time)).forEach(e=>{
          const row = document.createElement('div'); row.className = 'p-2 rounded border bg-white/90 flex items-center justify-between';
          row.innerHTML = `<div><span class="font-medium">${escapeHtml(e.title)}</span> â€¢ ${e.date} ${e.time}</div><div class="space-x-2"><button class="px-2 py-0.5 rounded bg-gray-100 hover:bg-gray-200 edit text-xs">Edit</button><button class="px-2 py-0.5 rounded bg-red-100 text-red-700 hover:bg-red-200 del text-xs">Delete</button></div>`;
          row.querySelector('.edit').addEventListener('click', ()=> {
            const t = prompt('Title:', e.title) || e.title; const time = prompt('Time:', e.time) || e.time;
            e.title=t; e.time=time; store.set(this.key,this.events); this.render();
          });
          row.querySelector('.del').addEventListener('click', ()=> { this.events = this.events.filter(x=>x.id!==e.id); store.set(this.key,this.events); this.render(); });
          list.appendChild(row);
        });
      }
    };

    /***********************
     * DOCUMENTS
     ***********************/
    const Docs = {
      key:'zentry_docs',
      docs:[],
      active:null,
      init(){
        this.docs = store.get(this.key, [{ id: uid(), title:'Getting Started', body:'Welcome to your docs!', updated: Date.now() }]);
        $('#doc-new').addEventListener('click', ()=> { this.active = { id: uid(), title:'Untitled', body:'', updated: Date.now() }; this.openEditor(); });
        $('#doc-close').addEventListener('click', ()=> this.closeEditor());
        $('#doc-save').addEventListener('click', ()=> this.saveActive());
      },
      render(){
        const grid = $('#doc-list'); grid.innerHTML='';
        this.docs.sort((a,b)=>b.updated-a.updated).forEach(d=>{
          const card = document.createElement('div'); card.className = 'p-3 rounded border bg-white hover:shadow cursor-pointer';
          card.innerHTML = `<div class="font-semibold">${escapeHtml(d.title)}</div><div class="text-xs text-gray-500 mt-1">${new Date(d.updated).toLocaleString()}</div><div class="mt-2 line-clamp-2 text-sm text-gray-700">${escapeHtml(d.body.slice(0,120))}</div><div class="mt-3 flex items-center justify-end space-x-2"><button class="px-2 py-0.5 text-xs rounded bg-gray-100 hover:bg-gray-200 edit">Open</button><button class="px-2 py-0.5 text-xs rounded bg-red-100 text-red-700 hover:bg-red-200 del">Delete</button></div>`;
          card.querySelector('.edit').addEventListener('click', ()=> { this.active = { ...d }; this.openEditor(); });
          card.querySelector('.del').addEventListener('click', ()=> { if (!confirm('Delete this document?')) return; this.docs = this.docs.filter(x=>x.id!==d.id); store.set(this.key,this.docs); this.render(); });
          grid.appendChild(card);
        });
      },
      openEditor(){ $('#doc-title').value = this.active.title; $('#doc-body').value = this.active.body; $('#doc-modal').classList.remove('hidden'); $('#doc-modal').classList.add('flex'); }
      ,
      closeEditor(){ $('#doc-modal').classList.add('hidden'); $('#doc-modal').classList.remove('flex'); }
      ,
      saveActive(){
        this.active.title = $('#doc-title').value.trim() || 'Untitled';
        this.active.body = $('#doc-body').value;
        this.active.updated = Date.now();
        const i = this.docs.findIndex(x=>x.id===this.active.id);
        if (i>=0) this.docs[i]=this.active; else this.docs.unshift(this.active);
        store.set(this.key,this.docs);
        this.closeEditor(); this.render(); toast('Document saved');
      }
    };

    /***********************
     * BOARDS
     ***********************/
    const Boards = {
      key:'zentry_boards',
      list:[],
      view:'list',
      editId:null,
      init(){
        this.list = store.get(this.key, [
          { id: uid(), name:'Sprint Planning', active:true, owner:'Alice', shared:['team@ex.com'], published: toISO(new Date()) },
          { id: uid(), name:'Design Review', active:false, owner:'Bob', shared:['design@ex.com','pm@ex.com'], published: toISO(new Date(Date.now()-86400000)) }
        ]);
        $('#board-view-tabs').addEventListener('click', (e)=> {
          const btn = e.target.closest('button'); if (!btn) return;
          this.view = btn.dataset.view; this.updateTabs(); this.render();
        });
        $('#board-search').addEventListener('input', ()=> this.render());
        $('#board-create-btn').addEventListener('click', ()=> this.openModal());
        $('#board-close').addEventListener('click', ()=> this.closeModal());
        $('#board-save').addEventListener('click', ()=> this.saveBoard());
        $('#board-delete').addEventListener('click', ()=> this.deleteBoard());
        $('#sort-name').addEventListener('click', ()=>{ this.list.sort((a,b)=>a.name.localeCompare(b.name)); this.render(); });
        $('#sort-active').addEventListener('click', ()=>{ this.list.sort((a,b)=> Number(b.active)-Number(a.active)); this.render(); });
        $('#sort-date').addEventListener('click', ()=>{ this.list.sort((a,b)=> (b.published||'').localeCompare(a.published||'')); this.render(); });
        this.updateTabs();
      },
      updateTabs(){
        $$('#board-view-tabs button').forEach(b=> b.classList.remove('bg-white','bg-opacity-40'));
        const btn = $(`#board-view-tabs button[data-view="${this.view}"]`); if (btn) btn.classList.add('bg-white','bg-opacity-40');
        $('#boards-header').classList.toggle('route-hidden', this.view!=='list');
        $('#boards-list').classList.toggle('route-hidden', this.view!=='list');
        $('#boards-grid').classList.toggle('route-hidden', this.view!=='grid');
        $('#boards-tile').classList.toggle('route-hidden', this.view!=='tile');
      },
      openModal(board){
        this.editId = board?.id || null;
        $('#board-modal-title').textContent = this.editId? 'Edit Board' : 'Create Board';
        $('#board-name').value = board?.name || '';
        $('#board-owner').value = board?.owner || 'You';
        $('#board-shared').value = (board?.shared || []).join(', ');
        $('#board-active').checked = !!board?.active;
        $('#board-published').value = board?.published || toISO(new Date());
        $('#board-delete').classList.toggle('hidden', !this.editId);
        $('#board-modal').classList.remove('hidden'); $('#board-modal').classList.add('flex');
      },
      closeModal(){ $('#board-modal').classList.add('hidden'); $('#board-modal').classList.remove('flex'); },
      saveBoard(){
        const item = {
          id: this.editId || uid(),
          name: $('#board-name').value.trim() || 'Untitled',
          owner: $('#board-owner').value.trim() || 'You',
          shared: $('#board-shared').value.split(',').map(s=>s.trim()).filter(Boolean),
          active: $('#board-active').checked,
          published: $('#board-published').value || toISO(new Date())
        };
        const i = this.list.findIndex(x=>x.id===item.id);
        if (i>=0) this.list[i]=item; else this.list.unshift(item);
        store.set(this.key,this.list); this.closeModal(); this.render(); toast('Board saved');
      },
      deleteBoard(){
        if (!this.editId) return;
        if (!confirm('Delete this board?')) return;
        this.list = this.list.filter(x=>x.id!==this.editId);
        store.set(this.key,this.list); this.closeModal(); this.render(); toast('Board deleted');
      },
      render(){
        const q = ($('#board-search').value || '').toLowerCase();
        const data = this.list.filter(b => [b.name,b.owner,(b.shared||[]).join(' ')].join(' ').toLowerCase().includes(q));
        // list view
        const list = $('#boards-list'); list.innerHTML='';
        data.forEach(b=>{
          const row = document.createElement('div'); row.className = 'grid grid-cols-5 px-6 py-3 border-b hover:bg-gray-50 cursor-pointer';
          row.innerHTML = `<div class="font-medium">${escapeHtml(b.name)}</div><div>${b.active ? '<span class="pill bg-green-100 text-green-700">Active</span>' : '<span class="pill bg-gray-100">Paused</span>'}</div><div>${escapeHtml(b.owner)}</div><div>${(b.shared||[]).map(s=>`<span class="badge bg-gray-100 mr-1">${escapeHtml(s)}</span>`).join('')}</div><div>${b.published || ''}</div>`;
          row.addEventListener('click', ()=> this.openModal(b));
          list.appendChild(row);
        });
        if (data.length===0 && this.view==='list'){
          const empty = document.createElement('div'); empty.className = 'flex flex-col items-center justify-center bg-white rounded-b-xl py-10';
          empty.innerHTML = `<img alt="Illustration" class="mb-6 select-none pointer-events-none" height="120" src="https://storage.googleapis.com/a1aa/image/7840dffb-ea07-4d18-70bb-b265506689ad.jpg" width="120"/><p class="text-gray-900 text-lg font-normal mb-2">No boards found</p><p class="text-gray-600 text-sm">Create, edit and share boards here.</p>`;
          list.appendChild(empty);
        }
        // grid view
        const grid = $('#boards-grid'); grid.innerHTML='';
        data.forEach(b=>{
          const card = document.createElement('div'); card.className = 'p-4 rounded-xl bg-white hover:shadow cursor-pointer';
          card.innerHTML = `<div class="flex items-center justify-between"><div class="font-semibold">${escapeHtml(b.name)}</div>${b.active?'<span class="pill bg-green-100 text-green-700">Active</span>':'<span class="pill bg-gray-100">Paused</span>'}</div><div class="text-xs text-gray-500 mt-1">Owner: ${escapeHtml(b.owner)}</div><div class="mt-2 text-xs">${(b.shared||[]).slice(0,3).map(s=>`<span class="badge bg-gray-100 mr-1">${escapeHtml(s)}</span>`).join('')}</div><div class="mt-3 text-xs text-gray-500">Published: ${b.published||''}</div>`;
          card.addEventListener('click', ()=> this.openModal(b));
          grid.appendChild(card);
        });
        // tile view
        const tile = $('#boards-tile'); tile.innerHTML='';
        data.forEach(b=>{
          const t = document.createElement('div'); t.className = 'rounded-xl overflow-hidden border bg-white cursor-pointer';
          t.innerHTML = `<div class="h-24 bg-gradient-to-r from-indigo-300 to-purple-300"></div><div class="p-3"><div class="font-semibold">${escapeHtml(b.name)}</div><div class="text-xs text-gray-500">By ${escapeHtml(b.owner)} â€¢ ${b.published||''}</div></div>`;
          t.addEventListener('click', ()=> this.openModal(b));
          tile.appendChild(t);
        });
      }
    };

    /***********************
     * DRIVE
     ***********************/
    const Drive = {
      key:'zentry_drive',
      files:[],
      init(){
        this.files = store.get(this.key, []);
        $('#drive-upload').addEventListener('click', ()=> $('#drive-input').click());
        $('#drive-input').addEventListener('change', (e)=> {
          const files = Array.from(e.target.files);
          files.forEach(f=>{
            const reader = new FileReader();
            reader.onload = ()=> {
              this.files.push({ id: uid(), name: f.name, size: f.size, type: f.type || 'file', data: reader.result, uploaded: Date.now() });
              store.set(this.key, this.files); this.render();
            };
            reader.readAsDataURL(f);
          });
          e.target.value = '';
        });
      },
      render(){
        const grid = $('#drive-list'); grid.innerHTML='';
        this.files.sort((a,b)=>b.uploaded-a.uploaded).forEach(f=>{
          const card = document.createElement('div'); card.className = 'p-3 rounded border bg-white';
          const preview = f.type.startsWith('image/') ? `<img src="${f.data}" alt="" class="w-full h-32 object-cover rounded mb-2">` : `<div class="w-full h-32 bg-gray-100 rounded mb-2 flex items-center justify-center"><i class="far fa-file text-2xl text-gray-400"></i></div>`;
          card.innerHTML = `${preview}<div class="font-medium truncate">${escapeHtml(f.name)}</div><div class="text-xs text-gray-500">${(f.size/1024).toFixed(1)} KB â€¢ ${new Date(f.uploaded).toLocaleString()}</div><div class="mt-2 flex items-center justify-end space-x-2"><a download="${escapeAttr(f.name)}" href="${f.data}" class="px-2 py-0.5 text-xs rounded bg-gray-100 hover:bg-gray-200">Download</a><button class="px-2 py-0.5 text-xs rounded bg-red-100 text-red-700 hover:bg-red-200 del">Delete</button></div>`;
          card.querySelector('.del').addEventListener('click', ()=> { if (!confirm('Delete file?')) return; this.files = this.files.filter(x=>x.id!==f.id); store.set(this.key,this.files); this.render(); });
          grid.appendChild(card);
        });
      }
    };

    /***********************
     * MAIL
     ***********************/
    const Mail = {
      key:'zentry_mail',
      items:[],
      active:null,
      init(){
        this.items = store.get(this.key, [
          { id: uid(), from:'hello@company.com', subject:'Welcome to Zentry', body:'We are glad to have you!', time: Date.now()-3600e3, read:false },
          { id: uid(), from:'hr@company.com', subject:'Policy Update', body:'Please read the attached policy.', time: Date.now()-7200e3, read:true }
        ]);
        $('#mail-compose').addEventListener('click', ()=> {
          const to = prompt('To:'); if (!to) return;
          const subject = prompt('Subject:') || '(no subject)';
          const body = prompt('Body:') || '';
          this.items.unshift({ id: uid(), from:'you@zentry.local', subject, body, time: Date.now(), read:true, to });
          store.set(this.key,this.items); this.render(); toast('Mail sent');
        });
      },
      render(){
        const list = $('#mail-list'); list.innerHTML='';
        this.items.sort((a,b)=>b.time-a.time).forEach(m=>{
          const li = document.createElement('li'); li.className = `p-2 rounded border bg-white cursor-pointer ${!m.read?'border-green-300':''}`;
          li.innerHTML = `<div class="flex items-center justify-between"><div class="font-medium truncate">${escapeHtml(m.subject)}</div><div class="text-xs text-gray-500">${new Date(m.time).toLocaleString()}</div></div><div class="text-xs text-gray-600 truncate">${escapeHtml(m.from)}</div>`;
          li.addEventListener('click', ()=> { this.active = m; m.read = true; store.set(this.key,this.items); this.renderView(); this.render(); });
          list.appendChild(li);
        });
        this.renderView();
      },
      renderView(){
        const v = $('#mail-view');
        if (!this.active){ v.innerHTML = `<div class="text-gray-500">Select an emailâ€¦</div>`; return; }
        v.innerHTML = `<div class="flex items-center justify-between mb-2"><div><div class="text-xl font-semibold">${escapeHtml(this.active.subject)}</div><div class="text-xs text-gray-500 mt-1">From: ${escapeHtml(this.active.from)} â€¢ ${new Date(this.active.time).toLocaleString()}</div></div><div class="space-x-2"><button id="mail-del" class="px-2 py-1 rounded bg-red-100 text-red-700 hover:bg-red-200 text-sm">Delete</button></div></div><div class="whitespace-pre-wrap">${escapeHtml(this.active.body)}</div>`;
        $('#mail-del').addEventListener('click', ()=> { this.items = this.items.filter(x=>x.id!==this.active.id); this.active=null; store.set(this.key,this.items); this.render(); });
      }
    };

    /***********************
     * WORKGROUPS
     ***********************/
    const Workgroups = {
      key:'zentry_wg',
      groups:[],
      init(){
        this.groups = store.get(this.key, [
          { id: uid(), name:'Developers', members: ['Alice','Bob','Carol'] },
          { id: uid(), name:'Designers', members: ['Dana','Eli'] }
        ]);
        $('#wg-add').addEventListener('click', ()=> {
          const name = prompt('Group name:'); if(!name) return;
          this.groups.push({ id: uid(), name, members: [] }); store.set(this.key,this.groups); this.render();
        });
      },
      render(){
        const grid = $('#wg-list'); grid.innerHTML='';
        this.groups.forEach(g=>{
          const card = document.createElement('div'); card.className = 'p-3 rounded border bg-white';
          card.innerHTML = `<div class="flex items-center justify-between"><div class="font-semibold">${escapeHtml(g.name)}</div><div class="text-xs text-gray-500">${g.members.length} members</div></div><div class="mt-2 text-sm">${g.members.map(m=>`<span class="badge bg-gray-100 mr-1">${escapeHtml(m)}</span>`).join('')}</div><div class="mt-3 flex items-center justify-end space-x-2"><button class="px-2 py-0.5 text-xs rounded bg-gray-100 hover:bg-gray-200 add">Add Member</button><button class="px-2 py-0.5 text-xs rounded bg-red-100 text-red-700 hover:bg-red-200 del">Delete</button></div>`;
          card.querySelector('.add').addEventListener('click', ()=> {
            const m = prompt('Member name:'); if(!m) return; g.members.push(m); store.set(this.key,this.groups); this.render();
          });
          card.querySelector('.del').addEventListener('click', ()=> {
            if(!confirm('Delete group?')) return; this.groups = this.groups.filter(x=>x.id!==g.id); store.set(this.key,this.groups); this.render();
          });
          grid.appendChild(card);
        });
      }
    };


    

    /***********************
     * Initialization
     ***********************/
    document.addEventListener('DOMContentLoaded', ()=> {
      // init modules
      Feed.init(); Messenger.init(); Kanban.init(); Calendar.init(); Docs.init(); Boards.init(); Drive.init(); Mail.init(); Workgroups.init();
      Router.init();
      updateMessageBadges();

      // quick actions
      $('#btn-upgrade').addEventListener('click', ()=> toast('ðŸŽ‰ You are on the Pro trial!'));
      // close modals on Escape
      document.addEventListener('keydown', (e)=> {
        if (e.key === 'Escape') {
          ['doc-modal','board-modal'].forEach(id => {
            const el = document.getElementById(id);
            if (el && el.classList && !el.classList.contains('hidden')) { el.classList.add('hidden'); el.classList.remove('flex'); }
          });
        }
      });
      // accessible close buttons already wired in each init
    });

    // small safety: avoid accidental form submits on Enter in inputs not intended to submit
    document.addEventListener('keydown', (e)=> {
      const t = e.target; if (e.key === 'Enter' && t && (t.tagName === 'INPUT' && t.type === 'text')) { /* allow */ }
    });
  </script>
</body>
</html>
